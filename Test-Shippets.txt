$modPath = "C:\Users\simatic\source\repos\tia-ps\TiaPsCmdlet\TiaCmdlet\bin\Debug\net462\TiaCmdlet.dll" 
Import-Module $modPath

Get-Command -Module TiaCmdlet
$tproject = "C:\Users\simatic\Documents\Automation\Project\Test1\Test1.ap16"

$tp = New-TiaInstance -withGui
$tp = Get-TiaInstance

$tp | Open-TiaProject -Path $tproject

$tp | Close-TiaProject
$tp | Close-TiaProject -Name XXX
$tp | Close-TiaProject -Name Test1

$tp | Get-TiaProject
$tp | Get-TiaProject -Name XXX
$tp | Get-TiaProject -Name Test1

$prj = Get-TiaProject -Portal $tp


$prj.Devices.Create("System:Device.S7300", "G1")

$prj | Get-TiaDevices -Path "G1"
$prj | Get-TiaDevices -Path "G1/RIO"
$prj | Get-TiaDevices -Path "G2/RII" -Debug